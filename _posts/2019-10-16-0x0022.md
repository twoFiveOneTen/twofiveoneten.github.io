---
layout: post
title: "Windows为VSCode添加右键快捷项"
date: 2019-10-16 10:41:00
modified: 2020-03-15 09:39:13
slug: 0x0022
categories: []
tags: []
comments: true
views: 4236
---
今天下午重新装了系统，然后又装上了 Visual Studio Code，但是装完后发现右键菜单没有 VSCode 快捷项，于是在网上搜索了一下解决方法，可以通过注册表手动添加。<!--more-->
### 添加快捷项
新建一个文本文件，把下面这段代码复制粘贴到文本文件中，并把代码中的四个`Code.exe`的路径都替换成你的 VSCode 实际安装路径（**注意是双反斜杠"\\\\"**），然后保存文件。再把文件重命名为`.reg`后缀文件，这里假设保存为`vsc.reg`。
```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\Directory\Background\shell\VSCode]
@="Open VSCode Here"
"Icon"="D:\\Microsoft VS Code\\Code.exe"

[HKEY_CLASSES_ROOT\Directory\Background\shell\VSCode\command]
@="D:\\Microsoft VS Code\\Code.exe ."

[HKEY_CLASSES_ROOT\Directory\shell\VSCode]
@="Open VSCode Here"
"Icon"="D:\\Microsoft VS Code\\Code.exe"

[HKEY_CLASSES_ROOT\Directory\shell\VSCode\command]
@="D:\\Microsoft VS Code\\Code.exe %1"
```

双击打开刚才保存的`vsc.reg`，然后确定把其写入注册表就可以了。

然后在选中文件夹上或背景处右键点击，菜单里都会出现 VSCode
[![Open VSCode Here](/img/0022/0022-1.png "Visual Studio Code Here")](/img/0022/0022-1.png "Visual Studio Code Here")

### 去除快捷项
由于是通过手动更改注册表添加的，所以卸载 VSCode 时这个快捷项并不会删掉，需要手动更改注册表去除右键快捷项。这里再写一下 Windows 系统如何删除，演示系统是 Windows10 。
1. 按`Win + R`快捷键打开`运行`，在输入框内输入`regedit`进入注册表编辑器[![进入注册表编辑器](/img/0022/0022-2.png "进入注册表编辑器")](/img/0022/0022-2.png "进入注册表编辑器")
2. 在注册表编辑器中有一个地址框，如下图中红框处，在地址栏中输入下面的地址，然后按`Enter`
```
计算机\HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Directory\background\shell\VSCode
```
如图，在左侧目录中右键点击`VSCode`文件夹，然后删除
[![删除](/img/0022/0022-3.png "删除")](/img/0022/0022-3.png "删除")
3. 需要进行同样操作的还有一个`VSCode`文件夹，地址是
```
计算机\HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Directory\shell\VSCode
```

> REFERENCE
- <a href="https://www.jianshu.com/p/d7e91b1e33e8">Windows 为VSCode添加右键菜单项 - chnmagnus</a>